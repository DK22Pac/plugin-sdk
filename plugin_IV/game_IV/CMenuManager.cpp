/*
    Plugin-SDK (Grand Theft Auto IV) source file
    Authors: GTA Community. See more here
    https://github.com/DK22Pac/plugin-sdk
    Do not delete this comment block. Respect others' work!
*/
#include "CMenuManager.h"

CMenuScreen* aScreens = gpatternt(CMenuScreen, "BE ? ? ? ? 0F B7 4E 04", 1); // [74];
int32_t* aPrefs = gpatternt(int32_t, "89 04 B5 ? ? ? ? 8B 3D", 3); // [165];

CSprite2d* CMenuManager::Frontend360Sprites = gpatternt(CSprite2d, "BE ? ? ? ? 8B CE E8 ? ? ? ? 83 C6 04 81 FE ? ? ? ? 7C EE E8 ? ? ? ? 83 FF FF 74 47", 1); // [10]
CSprite2d& CMenuManager::MouseCursorSprite = *gpatternt(CSprite2d, "B9 ? ? ? ? 68 ? ? ? ? E8 ? ? ? ? 68 ? ? ? ? B9 ? ? ? ? E8 ? ? ? ? 68 ? ? ? ? B9 ? ? ? ? E8 ? ? ? ? 68 ? ? ? ? B9 ? ? ? ? E8 ? ? ? ? 68 ? ? ? ? B9 ? ? ? ? E8 ? ? ? ? 68 ? ? ? ? B9 ? ? ? ? E8 ? ? ? ? 68 ? ? ? ? B9 ? ? ? ? E8 ? ? ? ? 68 ? ? ? ? B9 ? ? ? ? E8 ? ? ? ? E8", 1);
CSprite2d& CMenuManager::ReplayPointerSprite = *gpatternt(CSprite2d, "B9 ? ? ? ? E8 ? ? ? ? 68 ? ? ? ? B9 ? ? ? ? E8 ? ? ? ? 68 ? ? ? ? B9 ? ? ? ? E8 ? ? ? ? 68 ? ? ? ? B9 ? ? ? ? E8 ? ? ? ? 68 ? ? ? ? B9 ? ? ? ? E8 ? ? ? ? 68 ? ? ? ? B9 ? ? ? ? E8 ? ? ? ? 68 ? ? ? ? B9 ? ? ? ? E8 ? ? ? ? E8", 1);
CSprite2d& CMenuManager::ReplayPointerSprite2 = *gpatternt(CSprite2d, "B9 ? ? ? ? E8 ? ? ? ? 68 ? ? ? ? B9 ? ? ? ? E8 ? ? ? ? 68 ? ? ? ? B9 ? ? ? ? E8 ? ? ? ? 68 ? ? ? ? B9 ? ? ? ? E8 ? ? ? ? 68 ? ? ? ? B9 ? ? ? ? E8 ? ? ? ? 68 ? ? ? ? B9 ? ? ? ? E8 ? ? ? ? E8", 1);
CSprite2d& CMenuManager::ControllerSprite = *gpatternt(CSprite2d, "B9 ? ? ? ? E8 ? ? ? ? 68 ? ? ? ? B9 ? ? ? ? E8 ? ? ? ? 68 ? ? ? ? B9 ? ? ? ? E8 ? ? ? ? 68 ? ? ? ? B9 ? ? ? ? E8 ? ? ? ? 68 ? ? ? ? B9 ? ? ? ? E8 ? ? ? ? E8", 1);
CSprite2d* CMenuManager::MapSprites = gpatternt(CSprite2d, "B9 ? ? ? ? E8 ? ? ? ? 68 ? ? ? ? B9 ? ? ? ? E8 ? ? ? ? 68 ? ? ? ? B9 ? ? ? ? E8 ? ? ? ? 68 ? ? ? ? B9 ? ? ? ? E8 ? ? ? ? E8", 1); // [4]

int32_t& CMenuManager::m_PrefsMouseAccel = *gpatternt(int32_t, "C7 05 ? ? ? ? ? ? ? ? C7 05 ? ? ? ? ? ? ? ? A3 ? ? ? ? C7 05 ? ? ? ? ? ? ? ? C7 05 ? ? ? ? ? ? ? ? C7 05 ? ? ? ? ? ? ? ? C7 05 ? ? ? ? ? ? ? ? C7 05", 2);
int32_t& CMenuManager::m_PrefsAspectRatio = *gpatternt(int32_t, "C7 05 ? ? ? ? ? ? ? ? C7 05 ? ? ? ? ? ? ? ? C7 05 ? ? ? ? ? ? ? ? C7 05 ? ? ? ? ? ? ? ? C7 05 ? ? ? ? ? ? ? ? C7 05 ? ? ? ? ? ? ? ? C7 05 ? ? ? ? ? ? ? ? C7 05 ? ? ? ? ? ? ? ? C7 05 ? ? ? ? ? ? ? ? C7 05 ? ? ? ? ? ? ? ? C7 05 ? ? ? ? ? ? ? ? C7 05 ? ? ? ? ? ? ? ? 33 F6", 2);
int32_t& CMenuManager::m_PrefsLanguage = *gpatternt(int32_t, "A3 ? ? ? ? 75 5E", 1);
int32_t& CMenuManager::m_PrefsUseVibration = *gpatternt(int32_t, "C7 05 ? ? ? ? ? ? ? ? C7 05 ? ? ? ? ? ? ? ? C7 05 ? ? ? ? ? ? ? ? C7 05 ? ? ? ? ? ? ? ? C7 05 ? ? ? ? ? ? ? ? C7 05 ? ? ? ? ? ? ? ? A3 ? ? ? ? C7 05", 1);
bool& CMenuManager::m_MenuActive = *gpatternt(bool, "C6 05 ? ? ? ? ? C6 05 ? ? ? ? ? C6 05 ? ? ? ? ? 5E C3 CC CC CC CC CC CC CC CC CC CC", 2);
int32_t& CMenuManager::m_nWaypointIndex = *gpatternt(int32_t, "C7 05 ? ? ? ? ? ? ? ? C7 05 ? ? ? ? ? ? ? ? C7 05 ? ? ? ? ? ? ? ? C7 05 ? ? ? ? ? ? ? ? F3 0F 11 05 ? ? ? ? 8B 01", 2);
int32_t& CMenuManager::m_CurrScreen = *gpatternt(int32_t, "A1 ? ? ? ? 6A 09 A3 ? ? ? ? E8 ? ? ? ? 83 C4 04", 1);
int32_t& CMenuManager::m_PrevScreen = *gpatternt(int32_t, "A3 ? ? ? ? E8 ? ? ? ? 83 C4 04 C6 05", 1);
int32_t& CMenuManager::m_CurrState = *gpatternt(int32_t, "A3 ? ? ? ? B0 01 C3 CC CC CC CC 51", 1);
int32_t& CMenuManager::m_Episode = *gpatternt(int32_t, "89 35 ? ? ? ? C6 44 24 ? ? 6A 00", 2);
int8_t& CMenuManager::m_DontDrawMenuBar = *gpatternt(int8_t, "A2 ? ? ? ? 84 C0 74 15", 1);
int32_t& CMenuManager::m_EpisodeToStart = *gpatternt(int32_t, "C7 05 ? ? ? ? ? ? ? ? 5E C3 CC CC 56 8B F1", 2);
char*& CMenuManager::m_EpisodeStr = *gpatternt(char*, "A1 ? ? ? ? 85 C0 74 78", 1);
uint8_t& CMenuManager::m_SelectEpisode = *gpatternt(uint8_t, "C6 05 ? ? ? ? ? C6 05 ? ? ? ? ? C6 05 ? ? ? ? ? 5F C3", 2);
uint8_t& CMenuManager::m_DefaultFrontend = *gpatternt(uint8_t, "C6 05 ? ? ? ? ? C6 05 ? ? ? ? ? 5F C3", 2);
uint8_t& CMenuManager::m_Refresh = *gpatternt(uint8_t, "C6 05 ? ? ? ? ? 5F C3 3B 87", 2);

void CMenuManager::SwitchMenuScreen(int32_t arg1, int32_t screen, int32_t option) {
    plugin::CallDyn(gpattern("8B 44 24 08 83 EC 10 A3"), arg1, screen, option);
}

void CMenuManager::DrawMouseCursor() {
    plugin::CallDyn(gpattern("83 EC 2C 53 55 56 57 6A 01"));
}

void CMenuManager::SetHideMenuBar(uint8_t off) {
    plugin::CallDyn(gpattern("80 3D ? ? ? ? ? 75 48 80 3D ? ? ? ? ? 75 3F"));
}

int32_t CMenuManager::GetCurrentOption(int32_t index) {
    return plugin::CallAndReturnDyn<int32_t>(gpattern("8B 44 24 04 83 F8 A6 74 1B 8B 0C 85 ? ? ? ? 85 C9 74 10 80 B8 ? ? ? ? ? 74 07 8B 81 ? ? ? ? C3 33 C0 C3 CC CC CC CC CC CC CC CC CC 8B 44 24 04 83 F8 A6 74 12"), index);
}

void CMenuManager::DrawHelpText() {
    plugin::CallDyn(gpattern("55 8B EC 83 E4 F8 81 EC ? ? ? ? 53 56 8B 35 ? ? ? ? 57 85 F6"));
}

void CMenuManager::SetHelpText(const char* right, const char* left, uint8_t arg3) {
    plugin::CallDyn(gpattern("8B 4C 24 08 56 57 8B 3D ? ? ? ? 8B F7"), right, left, arg3);
}